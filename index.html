<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.7.3/js/bootstrap-select.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.7.3/css/bootstrap-select.min.css" rel="stylesheet"/>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" />

<link rel="stylesheet" type="text/css" href="style.css">

<!-- <script src="formScript.js"></script> -->
<script language="javascript" type="text/javascript" src="web3.min.js"></script>

<!-- FONTS -->
<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link href="https://fonts.googleapis.com/css?family=Bree+Serif|Muli|Nanum+Gothic|Open+Sans+Condensed:300|Open+Sans:300,400" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">

<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script language="javascript" type="text/javascript" src="abi.js"></script>
  <title>NP-Pay</title>
</head>
<body>
  <script>
  var abi = [
    {
      "constant": true,
      "inputs": [
        {
          "name": "problemId",
          "type": "uint256"
        },
        {
          "name": "solutionId",
          "type": "uint256"
        }
      ],
      "name": "can_trigger_auto_verification",
      "outputs": [
        {
          "name": "",
          "type": "bool"
        }
      ],
      "payable": false,
      "stateMutability": "view",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [
        {
          "name": "clauses",
          "type": "string"
        },
        {
          "name": "assignment",
          "type": "string"
        }
      ],
      "name": "verify_assignment_old",
      "outputs": [
        {
          "name": "",
          "type": "bool"
        }
      ],
      "payable": false,
      "stateMutability": "pure",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [
        {
          "name": "problemId",
          "type": "uint256"
        }
      ],
      "name": "get_SATProblem_info",
      "outputs": [
        {
          "name": "issuer",
          "type": "address"
        },
        {
          "name": "url",
          "type": "string"
        },
        {
          "name": "problem_hash",
          "type": "bytes32"
        },
        {
          "name": "num_vars",
          "type": "uint256"
        },
        {
          "name": "num_clauses",
          "type": "uint256"
        },
        {
          "name": "reward",
          "type": "uint256"
        },
        {
          "name": "solved",
          "type": "bool"
        }
      ],
      "payable": false,
      "stateMutability": "view",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [],
      "name": "owner",
      "outputs": [
        {
          "name": "",
          "type": "address"
        }
      ],
      "payable": false,
      "stateMutability": "view",
      "type": "function"
    },
    {
      "constant": false,
      "inputs": [
        {
          "name": "problemId",
          "type": "uint256"
        },
        {
          "name": "solutionId",
          "type": "uint256"
        }
      ],
      "name": "request_reward_old",
      "outputs": [],
      "payable": false,
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "constant": false,
      "inputs": [
        {
          "name": "problemId",
          "type": "uint256"
        },
        {
          "name": "hashId",
          "type": "uint256"
        },
        {
          "name": "assignment",
          "type": "string"
        }
      ],
      "name": "proposeSATSolution",
      "outputs": [
        {
          "name": "",
          "type": "uint256"
        }
      ],
      "payable": true,
      "stateMutability": "payable",
      "type": "function"
    },
    {
      "constant": false,
      "inputs": [
        {
          "name": "url",
          "type": "string"
        },
        {
          "name": "problem_hash",
          "type": "bytes32"
        },
        {
          "name": "num_vars",
          "type": "uint256"
        },
        {
          "name": "num_clauses",
          "type": "uint256"
        },
        {
          "name": "reward",
          "type": "uint256"
        }
      ],
      "name": "createSATProblem",
      "outputs": [
        {
          "name": "",
          "type": "uint256"
        }
      ],
      "payable": true,
      "stateMutability": "payable",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [
        {
          "name": "",
          "type": "uint256"
        }
      ],
      "name": "satToOwner",
      "outputs": [
        {
          "name": "",
          "type": "address"
        }
      ],
      "payable": false,
      "stateMutability": "view",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [],
      "name": "get_balance",
      "outputs": [
        {
          "name": "",
          "type": "uint256"
        }
      ],
      "payable": false,
      "stateMutability": "view",
      "type": "function"
    },
    {
      "constant": false,
      "inputs": [],
      "name": "retrieve_reward",
      "outputs": [],
      "payable": false,
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "constant": false,
      "inputs": [
        {
          "name": "problemId",
          "type": "uint256"
        },
        {
          "name": "solutionId",
          "type": "uint256"
        },
        {
          "name": "evidence",
          "type": "uint256"
        },
        {
          "name": "trigger_verify",
          "type": "bool"
        },
        {
          "name": "vote_up",
          "type": "bool"
        }
      ],
      "name": "vote_SAT",
      "outputs": [],
      "payable": true,
      "stateMutability": "payable",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [
        {
          "name": "problemId",
          "type": "uint256"
        },
        {
          "name": "solutionId",
          "type": "uint256"
        }
      ],
      "name": "can_trigger_manual_verification",
      "outputs": [
        {
          "name": "",
          "type": "bool"
        }
      ],
      "payable": false,
      "stateMutability": "view",
      "type": "function"
    },
    {
      "constant": true,
      "inputs": [
        {
          "name": "clause",
          "type": "string"
        },
        {
          "name": "assignment",
          "type": "string"
        }
      ],
      "name": "verify_assignment",
      "outputs": [
        {
          "name": "",
          "type": "bool"
        }
      ],
      "payable": false,
      "stateMutability": "pure",
      "type": "function"
    },
    {
      "constant": false,
      "inputs": [
        {
          "name": "newOwner",
          "type": "address"
        }
      ],
      "name": "transferOwnership",
      "outputs": [],
      "payable": false,
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "constant": false,
      "inputs": [
        {
          "name": "problemId",
          "type": "uint256"
        },
        {
          "name": "hash",
          "type": "bytes32"
        }
      ],
      "name": "proposeSATSolutionHash",
      "outputs": [
        {
          "name": "",
          "type": "uint256"
        }
      ],
      "payable": true,
      "stateMutability": "payable",
      "type": "function"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "name": "problemId",
          "type": "uint256"
        },
        {
          "indexed": false,
          "name": "solutionId",
          "type": "uint256"
        },
        {
          "indexed": false,
          "name": "vote",
          "type": "bool"
        },
        {
          "indexed": false,
          "name": "voter",
          "type": "address"
        }
      ],
      "name": "Vote_Cast",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "name": "problemId",
          "type": "uint256"
        },
        {
          "indexed": false,
          "name": "solutionId",
          "type": "uint256"
        },
        {
          "indexed": false,
          "name": "result",
          "type": "bool"
        }
      ],
      "name": "Verification_Performed",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "name": "problemId",
          "type": "uint256"
        },
        {
          "indexed": false,
          "name": "hashId",
          "type": "uint256"
        },
        {
          "indexed": false,
          "name": "time_proposed",
          "type": "uint256"
        }
      ],
      "name": "SATSolutionHashProposed",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "name": "problemId",
          "type": "uint256"
        },
        {
          "indexed": false,
          "name": "hashId",
          "type": "uint256"
        },
        {
          "indexed": false,
          "name": "solutionId",
          "type": "uint256"
        },
        {
          "indexed": false,
          "name": "time_proposed",
          "type": "uint256"
        }
      ],
      "name": "SATSolutionProposed",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": false,
          "name": "problemId",
          "type": "uint256"
        },
        {
          "indexed": false,
          "name": "num_vars",
          "type": "uint256"
        },
        {
          "indexed": false,
          "name": "num_clauses",
          "type": "uint256"
        },
        {
          "indexed": false,
          "name": "reward",
          "type": "uint256"
        }
      ],
      "name": "New_SAT_Problem",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "name": "previousOwner",
          "type": "address"
        },
        {
          "indexed": true,
          "name": "newOwner",
          "type": "address"
        }
      ],
      "name": "OwnershipTransferred",
      "type": "event"
    }
  ]
  var nppay;

  function startApp(){
    var nppayAddr = '0x43Ee8229Ed1BEe11706b806812447854FAc3b287';
    nppay = new web3js.eth.Contract(abi);
    console.log(nppay);
    nppay = nppay.options.address('0x43Ee8229Ed1BEe11706b806812447854FAc3b287');
    console.log(nppay);
  }

  function foo() {
    console.log("in foo")
    var ret =  nppay.methods.verify_assignment("121","111").call();
    console.log(ret);
    // return;
  }

  window.addEventListener('load', function() {

    // Checking if Web3 has been injected by the browser (Mist/MetaMask)
    if (typeof web3 !== 'undefined') {
      // Use Mist/MetaMask's provider
      console.log("We have Web3.js")
      web3js = new Web3(web3.currentProvider);
    }
    else {
      // Handle the case where the user doesn't have web3. Probably
      // show them a message telling them to install Metamask in
      // order to use our app.
      console.log("We don't have Web3.js!!")
    }

    // Now you can start your app & access web3js freely:
    startApp()

  })
  </script>
  <nav class="navbar navbar-default navbar-fixed-top navbar-light"
  style="background-color: #f7931a;border:none;">
  <div class="container-fluid">
    <div class="navbar-header navbar-light" style="background-color: #f7931a;">
      <a class="navbar-brand" href="index.html">
        <img alt="Brand" src="img/icon.png">
      </a>
      <p class="navbar-text" id ="navbar-title" style="font-weight:900;color:white">NP-Pay</p>
    </div>
    <ul class="nav navbar-nav navbar-right">
      <li>
        <a href="login.html" class="navbar-brand" id ="navbar-title">Login
        </a>
      </li>
    </ul>
  </div>
</nav>

<div id="container">

  <!-- HEADER TEXT -->
  <div class="headerDiv" id="div-border">
    <h1 id="h1-title">
      NP-Pay
    </h1>
  </br>
  <h3 id="h3-title">Trading Computation Power for Currency</h3></br>
</div>

<!-- </br></br></br> -->
<form class="form-horizontal" action="" onsubmit="foo()">
  <div class="col-sm-offset-2 col-sm-10">
    <button type="submit" class="btn btn-default">Submit</button>
  </div>
</form>
<div class="innerDivButtons">
  <a id="mainButton" href="problem.html">
    Issue a Problem</br></br>
    <img id="mainIcon" src="img/upload.png"/>
  </a>
  <a id="mainButton" href="solve.html">
    Solve a Problem</br></br>
    <img id="mainIcon" src="img/solve.png"/>
  </a>
  <a id="mainButton" href="verify.html">
    Verify a Problem</br></br>
    <img id="mainIcon" src="img/verify.png"/>
  </a>
</div>
<div class="innerDiv">
  <h3 id="h3-title">How it works</h3>
</br>
<p id="para">Details</p>
</div>

</body>
</html>
